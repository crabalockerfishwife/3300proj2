
<!DOCTYPE html>

<!-- Map generation code sourced from -->
<!-- https://medium.com/@andybarefoot/making-a-map-using-d3-js-8aa3637304ee -->

<html>
<head>
    <title> </title>
    <meta charset="utf-8" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <!-- Did not write this stylesheet -->
    <link rel = "stylesheet" type = "text/css" href = "not_written_style.css" />

    <link rel = "stylesheet" type = "text/css" href = "style.css" />
	<script src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" integrity="sha384-slN8GvtUJGnv6ca26v8EzVaR9DC58QEwsIk9q1QXdCU8Yu8ck/tL/5szYlBbqmS+" crossorigin="anonymous"></script>

</head>


<body>
	
    <div id="">
      <p id="">
      </p>
    </div>

	
<div id="map-holder"></div>
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js"></script>
	<script src="https://use.fontawesome.com/releases/v5.0.10/js/all.js" ></script>
    <script>

      // Code to populate the value array (of extinct languages) associated with an American country key
      function populate(americanCountries, rawExtinctData, americanCountriesWithLang) {
          var i;
          for (i = 0; i < americanCountries.length; i++) {
              //console.log(americanCountries[i]);
              var j;
              for (j = 0; j < rawExtinctData.length; j++) {
                  //console.log(rawExtinctData[j].countriesWithLang.split(", "));
                  if (rawExtinctData[j].countriesWithLang.split(", ").includes(americanCountries[i])){
                      americanCountriesWithLang[i].value.push(rawExtinctData[j].language);
                  }
              }
          }
          //console.log(americanCountriesWithLang);
    }


    //Our code to parse the extinct language data
    
      function initialDataParsing(callback) {
      result = [];
      rawExtinctData = [];
      americanCountriesWithLang = [];
      americanCountries = [];
      
      function parseExtinctData(line) {
        return {
          language: line["Name in English"],
          countriesWithLang: line["Countries"] 
        };
      };
      
      function parseAmericanCountries(row) {    
        result.push(row["Country"]);
        return result;   
      };
      
      d3.csv("extinctlangs.csv", parseExtinctData, function(error, extinct){
        rawExtinctData = extinct;
      });
        
      d3.csv("AmericanCountries.csv", parseAmericanCountries, function(error, amer){
         americanCountries = result;
         var j = 0;
         americanCountries.forEach(function(){
            
         langArr = [];
         var k = 0;
         rawExtinctData.forEach(function() {
              
         if (rawExtinctData[k].countriesWithLang.includes(americanCountries[j])){
            langArr.push(rawExtinctData[k].language);
          }
            k++;
          });
            
          americanCountriesWithLang.push({key: americanCountries[j], value: langArr});
            j++;
            
          });
        
        });

      setTimeout(function() { callback(americanCountries, rawExtinctData, americanCountriesWithLang); }, 2000);
      
    }

    initialDataParsing(populate);

   
    </script>
    <script src="not_our_viz_code.js"></script><!-- We did not write this code; we made slight modifications to original file -->
    
</body>
</html>